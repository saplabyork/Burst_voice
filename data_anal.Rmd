---
title: "Data analysis"
output: 
  html_document:
    includes:
      in_header: "favicon.html"
    theme: paper
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 3
---

<style type="text/css">
  body{
  font-size: 12pt;
}
</style>

<style type="text/css">
.title {
  display: none;
}

#getting-started img {
  margin-right: 10px;
}

</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Preliminary plotting

# By Onset POA

This is just a first pass at looking at the data so far.

```{r}
data <- read.csv("/Users/chandannarayan/GitHub/Burst_voice/Data/data_03-02-24.csv", header=TRUE)
data$coda_vc <- as.character(data$coda_vc) #change class of coda_vc
data$ons_poa <- as.character(data$ons_poa) #change class of ons_poa
library(ggplot2)

plot <- ggplot(data, aes(x = ons_poa,y = vot, fill = coda_vc)) + geom_boxplot(outlier.shape = NA) + ylim(0, 0.15) + facet_wrap(~ons_poa, scale = "free") + 
  stat_summary(fun = median,geom = "text",aes(label = paste("Median:", round(..y.., 3))),  # Label with median values
    vjust = -0.5,  # Vertical position of the text (adjust as needed)
    position = position_dodge(width = 0.75),  # Dodge the text for better visibility
    show.legend = FALSE  # Do not show in legend
  )

plot
```

# By Onset POA and Vowel

```{r}
plot_vowel <- ggplot(data, aes(x = vowel,y = vot, fill = coda_vc)) + geom_boxplot(outlier.shape = NA) + facet_wrap(~ons_poa, scale = "free")
plot_vowel
```

It looks like there is a clear effect of coda voicing on voiceless onset VOT.

# Basic models

```{r}
library(lme4)
library(tidyverse)
data_mod <- data %>%
  #rename POA labels from 1,2,3 to p,t,k
  mutate(ons_poa = recode(ons_poa, "1" = "p-", "2" = "t-", "3" = "k-"))

model <- lmer(vot ~ ons_poa * vdur + (1 | sub) + (1 | vowel), data = data_mod)
summary(model)

p <- ggplot(data_mod, aes(x=vdur, y=vot, color=coda_vc)) +
  geom_point(outlier.shape = NA) +
  geom_smooth(method=lm) + xlab("Vowel dur (ms)") + ylab("VOT (ms)")
p + facet_wrap(~ons_poa)
```